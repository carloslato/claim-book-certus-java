<html xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
  layout:decorate="~{layout.html}">
	
<div layout:fragment="content">

	<div class="uk-card uk-card-default uk-card-body">
	
	    <h3>Enviar Reclamo</h3>
	
	    <form id="form-reclamo">
	
	        <div class="uk-margin">
	            <input class="uk-input" name="nombre" placeholder="Nombre" required>
	        </div>
	
	        <div class="uk-margin">
	            <input class="uk-input" name="correo" placeholder="Correo">
	        </div>
	
	        <div class="uk-margin">
	            <textarea class="uk-textarea" name="descripcion" placeholder="DescripciÃ³n" required></textarea>
	        </div>
	
	        <button class="uk-button uk-button-primary">Enviar</button>
	
	    </form>
	</div>

</div>


<script layout:fragment="script">
	
document.querySelector("#form-reclamo").addEventListener("submit", async (e)=>{
    e.preventDefault();

    const data = Object.fromEntries(new FormData(e.target));

    const resp = await fetch("/api/reclamos", {
        method:"POST",
        headers:{ "Content-Type":"application/json" },
        body: JSON.stringify(data)
    });

    const json = await resp.json();

    if(resp.ok){
        window.location = "/reclamos/gracias?codigo=" + json.codigo_seguimiento;
    }else{
        alert("Error al enviar");
    }
});
</script>

</html>
